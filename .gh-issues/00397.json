{
    "url": "https://api.github.com/repos/ethereumclassic/ECIPs/issues/397",
    "repository_url": "https://api.github.com/repos/ethereumclassic/ECIPs",
    "labels_url": "https://api.github.com/repos/ethereumclassic/ECIPs/issues/397/labels{/name}",
    "comments_url": "https://api.github.com/repos/ethereumclassic/ECIPs/issues/397/comments",
    "events_url": "https://api.github.com/repos/ethereumclassic/ECIPs/issues/397/events",
    "html_url": "https://github.com/ethereumclassic/ECIPs/issues/397",
    "id": 752895379,
    "node_id": "MDU6SXNzdWU3NTI4OTUzNzk=",
    "number": 397,
    "title": "ECIP-1099 critical bug in reference code",
    "user": {
      "login": "biospb",
      "id": 42325079,
      "node_id": "MDQ6VXNlcjQyMzI1MDc5",
      "avatar_url": "https://avatars2.githubusercontent.com/u/42325079?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/biospb",
      "html_url": "https://github.com/biospb",
      "followers_url": "https://api.github.com/users/biospb/followers",
      "following_url": "https://api.github.com/users/biospb/following{/other_user}",
      "gists_url": "https://api.github.com/users/biospb/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/biospb/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/biospb/subscriptions",
      "organizations_url": "https://api.github.com/users/biospb/orgs",
      "repos_url": "https://api.github.com/users/biospb/repos",
      "events_url": "https://api.github.com/users/biospb/events{/privacy}",
      "received_events_url": "https://api.github.com/users/biospb/received_events",
      "type": "User",
      "site_admin": false
    },
    "labels": [
      {
        "id": 2281247217,
        "node_id": "MDU6TGFiZWwyMjgxMjQ3MjE3",
        "url": "https://api.github.com/repos/ethereumclassic/ECIPs/labels/editor:5%20needs-review",
        "name": "editor:5 needs-review",
        "color": "d9ef8b",
        "default": false,
        "description": "This contribution needs a careful review."
      },
      {
        "id": 2281210709,
        "node_id": "MDU6TGFiZWwyMjgxMjEwNzA5",
        "url": "https://api.github.com/repos/ethereumclassic/ECIPs/labels/status:9%20final",
        "name": "status:9 final",
        "color": "252525",
        "default": false,
        "description": "ECIP has been activated on testnet and/or mainnet."
      },
      {
        "id": 1154785127,
        "node_id": "MDU6TGFiZWwxMTU0Nzg1MTI3",
        "url": "https://api.github.com/repos/ethereumclassic/ECIPs/labels/type:%20std-core",
        "name": "type: std-core",
        "color": "fdcdac",
        "default": false,
        "description": "ECIPs of the type \"Core\" - changing the Classic protocol."
      }
    ],
    "state": "closed",
    "locked": false,
    "assignee": null,
    "assignees": [

    ],
    "milestone": null,
    "comments": 2,
    "created_at": "2020-11-29T11:30:21Z",
    "updated_at": "2020-12-04T09:22:20Z",
    "closed_at": "2020-12-04T09:22:20Z",
    "author_association": "NONE",
    "active_lock_reason": null,
    "body": "Hello\r\n\r\nRecently I tried to add this ECIP support to ethminer and found that reference code provided in this ECIP probably contains a bug in seedHash(block) function. It results in DAG rebuild every 30000 blocks, having the same size and epoch number!\r\n\r\nLets see: block number / old epoch / new epoch / seed cycles\r\n11700000 / 390 / 195 / 390\r\n11730000 / 391 / 195 / 391 <--- BUG. Is it supposed to be 390 ?\r\n11760000 / 392 / 196 / 392\r\n\r\nGeth has different implementation so DAG remains the same across all 60000 blocks.\r\n\r\nIf this really a bug the reference code of this function should be like this\r\n\r\n```\r\nfunc seedHash(block uint64) []byte {\r\n  seed := make([]byte, 32)\r\n  if block < oldEpochLength {\r\n    return seed\r\n  }\r\n  // keep using oldEpochLength here so seeds don't overlap\r\n  **// use epoch number to keep seed constant for entire epoch**\r\n  keccak256 := makeHasher(sha3.NewLegacyKeccak256())\r\n  for i := 0; i < int(**calcEpoch(block)*calcEpochLength(block)**/oldEpochLength); i++ {\r\n    keccak256(seed, seed)\r\n  }\r\n  return seed\r\n}\r\n```\r\n\r\nOtherwise the bug is in Geth",
    "reactions": {
      "url": "https://api.github.com/repos/ethereumclassic/ECIPs/issues/397/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  }